<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Lightstack by mckay20</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Lightstack</h1>
      <h2 class="project-tagline">Lightstack is an MVC framework to be simple, extendable, powerful and light weight!</h2>
      <a href="https://github.com/mckay20/lightstack" class="btn">View on GitHub</a>
      <a href="https://github.com/mckay20/lightstack/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/mckay20/lightstack/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="lightstack" class="anchor" href="#lightstack" aria-hidden="true"><span class="octicon octicon-link"></span></a>Lightstack</h1>

<p>Lightstack is a new MVC frontend architecture. It is designed to be quick to learn and impliment and ultra light weight. Many libraries are restrictive to how they can be used but our objective was to create something simple, powerful and extendable.  </p>

<p>Try it out here: <a href="https://jsfiddle.net/rm8e13ae/1/embedded/result/">https://jsfiddle.net/rm8e13ae/1/embedded/result/</a></p>

<h3>
<a id="version-01" class="anchor" href="#version-01" aria-hidden="true"><span class="octicon octicon-link"></span></a>Version 0.1</h3>

<h3>
<a id="architecture" class="anchor" href="#architecture" aria-hidden="true"><span class="octicon octicon-link"></span></a>Architecture</h3>

<p>When designing software, architecture is the biggest benifit or problem that you will ultimatly have to deal with. If you use a solid architecture, the complex issues will become easier. In turn, if you use bad architecture, everything will eventually get to a point where it becomes unmanagable. Lightstack is based on the MVC architecture and is designed to help you keep your code in a managable layout and design.</p>

<h3>
<a id="view" class="anchor" href="#view" aria-hidden="true"><span class="octicon octicon-link"></span></a>View</h3>

<p>A view is simply designated as a .js file that directly represents a view in the UI. Every popup, and view, should have a cooresponding .js file. This file will handle all logic that the view will perform. From event handlers to writing client side code, the views .js file will handle all interaction that can be performed on a UI screen (or section of screen).</p>

<div class="highlight highlight-source-shell"><pre>ls.add_view(<span class="pl-s"><span class="pl-pds">'</span>equipment<span class="pl-pds">'</span></span>, <span class="pl-en">function</span>(){
    // Set the model <span class="pl-k">for</span> the view
    this.model = ls.Models.pattern<span class="pl-k">;</span>

    this.list_container = <span class="pl-s"><span class="pl-pds">'</span>#List<span class="pl-pds">'</span></span><span class="pl-k">;</span>
    this.form_container = <span class="pl-s"><span class="pl-pds">'</span>#CreateForm<span class="pl-pds">'</span></span><span class="pl-k">;</span>

    // The base object defines properties but also how to describe a create form
    this.base_object = {
        id: {
            <span class="pl-c1">type</span>: <span class="pl-s"><span class="pl-pds">'</span>hidden<span class="pl-pds">'</span></span>
        },
        name: {
            title: <span class="pl-s"><span class="pl-pds">'</span>Name<span class="pl-pds">'</span></span>,
            <span class="pl-c1">type</span>: <span class="pl-s"><span class="pl-pds">'</span>text<span class="pl-pds">'</span></span>,
            required: <span class="pl-c1">true</span>,
            read_only: <span class="pl-c1">false</span>,
            placeholder: <span class="pl-s"><span class="pl-pds">'</span>name goes here<span class="pl-pds">'</span></span>
        },
        description: {
            title: <span class="pl-s"><span class="pl-pds">'</span>Description<span class="pl-pds">'</span></span>,
            <span class="pl-c1">type</span>: <span class="pl-s"><span class="pl-pds">'</span>text<span class="pl-pds">'</span></span>,
            required: <span class="pl-c1">true</span>,
            read_only: <span class="pl-c1">false</span>,
            placeholder: <span class="pl-s"><span class="pl-pds">'</span>desc<span class="pl-pds">'</span></span>
        }
    }<span class="pl-k">;</span>

    // Initialize the view
    ls.init_view(<span class="pl-s"><span class="pl-pds">'</span>equipment<span class="pl-pds">'</span></span>, this, <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>)<span class="pl-k">;</span>

    // Setup custom listeners <span class="pl-k">in</span> the view. this.create is a base class method
    this.add_listener(<span class="pl-s"><span class="pl-pds">'</span>#CreateNewBtn<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>click<span class="pl-pds">'</span></span>, this.create)<span class="pl-k">;</span>
    this.add_listener(<span class="pl-s"><span class="pl-pds">'</span>.deleteItem<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>click<span class="pl-pds">'</span></span>, <span class="pl-en">function</span>(){
        // Remove the item from the model that is tied to the view
        <span class="pl-en">_this.model.delete($(this).parent</span>().attr(<span class="pl-s"><span class="pl-pds">'</span>data-id<span class="pl-pds">'</span></span>));
    })<span class="pl-k">;</span>

    // Set a custom list template <span class="pl-k">for</span> each list item that will be rendered.
    this.list_template(function(item){
        <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;div data-id="<span class="pl-pds">'</span></span> + item.id + <span class="pl-s"><span class="pl-pds">'</span>"&gt;<span class="pl-pds">'</span></span> + item.name + <span class="pl-s"><span class="pl-pds">'</span> &lt;span class="deleteItem"&gt;delete&lt;/span&gt;&lt;/div&gt;<span class="pl-pds">'</span></span><span class="pl-k">;</span>
    })<span class="pl-k">;</span>

    var _this = this<span class="pl-k">;</span>
})<span class="pl-k">;</span></pre></div>

<p>The great part about Lightstack is that everything is customizable and you can adjust any property of the framework to meet the needs of your app. I find that rarly do I create an app that I am able to simply use the same view base functionality. Models are a different story, but for views, you may find yourself writing your own custom version of the view_base.js file or tweaking these files to get everything just right. The view_base.js is meant to get you started and hopefully cover many of the simpler senarios.</p>

<h3>
<a id="view-base-methods" class="anchor" href="#view-base-methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>View Base Methods</h3>

<p>These are the most common used methods in the view_base.js. You may over ride any method in the class or even simply alter the base class to fit your needs.</p>

<ul>
<li>
<code>list_template</code> - Accepts a method to be used as the HTML creator for a list item. This method should return an HTML string.</li>
<li>
<code>form_template</code> - Accepts a method to be used as the HTML creator for a form row item. This method should return an HTML string.</li>
<li>
<code>details_template</code> - Accepts a method to be used as the HTML creator for an items detail view. This method should return an HTML string.</li>
<li>
<code>add_listener</code> - Creates an event for a selector like jQuery. (CSS_Selector, action, callback) </li>
<li>
<code>set_contents</code> - Sets the content of a container and binds all handlers automatically. Can be used in place of $.html()</li>
<li>
<code>base_object</code> - This variable can be used to describe the base object that will be used by the view.</li>
</ul>

<h3>
<a id="models" class="anchor" href="#models" aria-hidden="true"><span class="octicon octicon-link"></span></a>Models</h3>

<p>Models are designed to be the data guardians of an app. Only the model can make changes to the data regardless of storage location. Obstraction is a large part of a models role on an app. They are the gate keepers that keep the data in check and notify views and other models when their data has changed.  </p>

<p>Models are built around an event based architecture that emits events when data in the model is changed. The base model will also try to keep it's data in sync with the storage engine. The below example shows how simple it can be to create a new model that uses localStorage as its storage engine.</p>

<div class="highlight highlight-source-shell"><pre>ls.add_model(<span class="pl-s"><span class="pl-pds">'</span>pattern<span class="pl-pds">'</span></span>, <span class="pl-en">function</span>(){
    ls.init_model(this, <span class="pl-c1">false</span>, <span class="pl-c1">true</span>)<span class="pl-k">;</span>
})<span class="pl-k">;</span></pre></div>

<p>Since most web apps use a database that resides on a server, the model must get its data from that server and make requests to update the servers database when client changes are made. The below code shows how you might go about doing that through ajax requests. There are four main CRUD handlers that need to be implimented so that the model can request and update your storage engine as needed.</p>

<div class="highlight highlight-source-shell"><pre>/<span class="pl-k">**************************************************</span>
 <span class="pl-k">*</span> Cloud Storage Example
 <span class="pl-k">*</span>
 <span class="pl-k">*</span> This example shows how to implement a custom storage engine using
 <span class="pl-k">*</span> an online database and basic ajax requests.
 <span class="pl-k">***************************************************</span>/

/<span class="pl-k">**</span>
 <span class="pl-k">*</span> Create a new Model using the <span class="pl-s"><span class="pl-pds">"</span>add_model<span class="pl-pds">"</span></span> method of the LightStack controller.
 <span class="pl-k">*</span> Initialize the model with a name and create an anonymous <span class="pl-k">function</span> <span class="pl-en">for</span> the model.
 <span class="pl-k">*</span>
 <span class="pl-k">*</span> @param name - You must pass back the data retrieved by storage engine as an array.
 <span class="pl-k">*</span>/
ls.add_model(<span class="pl-s"><span class="pl-pds">'</span>pattern<span class="pl-pds">'</span></span>, <span class="pl-en">function</span>(){
    /<span class="pl-k">**</span>
     <span class="pl-k">*</span> Initialize the model.
     <span class="pl-k">*</span>
     <span class="pl-k">*</span> @param model - You must pass <span class="pl-k">in</span> a reference to this class.
     <span class="pl-k">*</span> @param noAutoLoad - If you <span class="pl-c1">set</span> the noAutoLoad param to <span class="pl-c1">false</span>, the model will not automatically load with data.
     <span class="pl-k">*</span> You will have to load it manually later. To load a model, simply call the <span class="pl-s"><span class="pl-pds">'</span>init()<span class="pl-pds">'</span></span> method.
     <span class="pl-k">*</span> @param offline - If you <span class="pl-c1">set</span> offline to <span class="pl-c1">true</span>, the model will automatically save data to localStorage.
     <span class="pl-k">*</span> This will be overridden by your handler methods<span class="pl-k">!</span>
     <span class="pl-k">*</span>/
    ls.init_model(this)<span class="pl-k">;</span>

    /<span class="pl-k">************************************</span>
     Handler Methods
     ------------------------------------
     The handler functions can be best understood as the methods used to go
     retrieve the data from a generic storage engine. This could be through
     localStorage, a <span class="pl-k">local</span> database, an external database or a combination of sources.
     <span class="pl-k">*************************************</span>/
    this.set_handler(<span class="pl-s"><span class="pl-pds">'</span>create<span class="pl-pds">'</span></span>, Create)<span class="pl-k">;</span>
    this.set_handler(<span class="pl-s"><span class="pl-pds">'</span>update<span class="pl-pds">'</span></span>, Update)<span class="pl-k">;</span>
    this.set_handler(<span class="pl-s"><span class="pl-pds">'</span>delete<span class="pl-pds">'</span></span>, Delete)<span class="pl-k">;</span>
    this.set_handler(<span class="pl-s"><span class="pl-pds">'</span>get_all<span class="pl-pds">'</span></span>, GetData)<span class="pl-k">;</span>


    /<span class="pl-k">**</span>
     <span class="pl-k">*</span> This method is called to retrieve data on initialization of the object and throughout
     <span class="pl-k">*</span> the life of the model. It will be called to retrieve data from the storage <span class="pl-c1">source</span> and
     <span class="pl-k">*</span> keep the memory based Model up to date.
     <span class="pl-k">*</span>
     <span class="pl-k">*</span> @param callback - You must pass back the data retrieved by storage engine as an array.
     <span class="pl-k">*</span>/
    <span class="pl-k">function</span> <span class="pl-en">GetData(callback){</span>
        $.get(<span class="pl-s"><span class="pl-pds">'</span>/pattern/all<span class="pl-pds">'</span></span>, callback)<span class="pl-k">;</span>
    }

    /<span class="pl-k">**</span>
     <span class="pl-k">*</span> This method is updating the storage system to reflect the changes that have been
     <span class="pl-k">*</span> made to the objects <span class="pl-k">in</span> memory. The call is coming from the Add action.
     <span class="pl-k">*</span>
     <span class="pl-k">*</span> @param obj - The object that needs to be added
     <span class="pl-k">*</span> @param callback - This must be called <span class="pl-k">in</span> order <span class="pl-k">for</span> the base Model to <span class="pl-k">function</span> <span class="pl-en">correctly</span>
     <span class="pl-k">*</span>/
    <span class="pl-k">function</span> <span class="pl-en">Create(obj,</span> callback){
        $.post(<span class="pl-s"><span class="pl-pds">'</span>/pattern/create<span class="pl-pds">'</span></span>, obj, function(res){
            <span class="pl-en">callback</span>();
        })<span class="pl-k">;</span>
    }

    /<span class="pl-k">**</span>
     <span class="pl-k">*</span> This method is updating the storage system to reflect the changes that have been
     <span class="pl-k">*</span> made to the objects <span class="pl-k">in</span> memory. The call is coming from the Update action.
     <span class="pl-k">*</span>
     <span class="pl-k">*</span> @param obj - The object that needs to be updated
     <span class="pl-k">*</span> @param callback - This must be called <span class="pl-k">in</span> order <span class="pl-k">for</span> the base Model to <span class="pl-k">function</span> <span class="pl-en">correctly</span>
     <span class="pl-k">*</span>/
    <span class="pl-k">function</span> <span class="pl-en">Update(obj,</span> callback){
        $.post(<span class="pl-s"><span class="pl-pds">'</span>/pattern/update<span class="pl-pds">'</span></span>, obj, function(res){
            <span class="pl-en">callback</span>();
        })<span class="pl-k">;</span>
    }

    /<span class="pl-k">**</span>
     <span class="pl-k">*</span> This method is updating the storage system to reflect the changes that have been
     <span class="pl-k">*</span> made to the objects <span class="pl-k">in</span> memory. The call is coming from the Delete action.
     <span class="pl-k">*</span>
     <span class="pl-k">*</span> @param obj - The object that needs to be updated
     <span class="pl-k">*</span> @param callback - This must be called <span class="pl-k">in</span> order <span class="pl-k">for</span> the base Model to <span class="pl-k">function</span> <span class="pl-en">correctly</span>
     <span class="pl-k">*</span>/
    <span class="pl-k">function</span> <span class="pl-en">Delete(obj,</span> callback){
        $.post(<span class="pl-s"><span class="pl-pds">'</span>/pattern/delete<span class="pl-pds">'</span></span>, obj, function(res){
            <span class="pl-en">callback</span>();
        })<span class="pl-k">;</span>
    }
})<span class="pl-k">;</span></pre></div>

<h3>
<a id="model-base-methods" class="anchor" href="#model-base-methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model Base Methods</h3>

<p>As with the view base class, the model base class exposes various methods that are meant to be used and others that can be overwritten as needed.</p>

<ul>
<li>
<code>set_data</code> - This method will set the data for the model. Data should be formated as an object with the id being the key for the item. <code>{ id: {id: 'id', name: 'test'}, id2: {id: 'id2', name: 'test'}}</code>
</li>
<li>
<code>get</code> - Can be used to return a single item from the model using an ID.</li>
<li>
<code>get_all</code> - Used to return the entire list of objects.</li>
<li>
<code>add</code> - Adds a new item to the model. The new item must have an "id" property</li>
<li>
<code>update</code> - Updates an item within a model. The item must have an "id" property</li>
<li>
<code>delete</code> - Deletes an item from a model using an "id".</li>
<li>
<code>set_handler</code> - Sets a function to be called for <code>get, create, update, delete</code> calls. These methods control how data is sent or stored outside of the model.</li>
<li>
<code>add_event</code> - Creates a custom event that other views and models can bind to. The default events are <code>added, removed, changed, all_changed</code> </li>
<li>
<code>remove_event</code> - Removes an even from the model. Note that if any objects are trying to bind to that event, they will throw an exception.</li>
</ul>

<h3>
<a id="model-events" class="anchor" href="#model-events" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model Events</h3>

<p>The base model comes with four defined events:</p>

<ul>
<li>
<code>added</code> - This event fires whenever a new item is added to the model. The callback will be passed the added object</li>
<li>
<code>removed</code> - This event fires whenever an item is removed from the model. The callback will be passed the removed object</li>
<li>
<code>changed</code> - This event fires whenever an item has been updated or changed. The callback will be passed the changed object</li>
<li>
<code>all_changed</code> - This even fires whenever the models object list is changed. This will be on add, remove, and initialization</li>
</ul>

<p>You can bind to a models events anywhere following the models script declaration. The below code will run any time a models objects are updated.</p>

<div class="highlight highlight-source-shell"><pre>    ls.Models.patterns.on(ModelEvents.all_changed, function(objects){
        // Do something with the objects
    })<span class="pl-k">;</span></pre></div>

<h3>
<a id="controller" class="anchor" href="#controller" aria-hidden="true"><span class="octicon octicon-link"></span></a>Controller</h3>

<p>The last piece of the puzzle is the controller. The controllers job is to tie the view and model together. You can place additional logic in the controller as needed but the logic should be thought to be code used by any view or model. Placing a custom alert or confirm box would be a good example of a method that could exist in the controller.</p>

<p>The main methods of a controller are:</p>

<ul>
<li>
<code>add_view</code> - Creates a new view in the ls.Views object.</li>
<li>
<code>init_view</code> - Initializes a view. This must be called on any view wanting to the Lightstack base_view object</li>
<li>
<code>add_model</code> - Creates a new model in the ls.Models object</li>
<li>
<code>init_model</code> - Initializes a model. This must be called on any model using the Lightstack base_model object</li>
<li>
<code>show_view</code> - Show a view by name.</li>
<li>
<code>show_view_only</code> - Hides all views except for the named view</li>
<li>
<code>hide_view</code> - Hides the view by name</li>
</ul>

<h3>
<a id="more-to-come" class="anchor" href="#more-to-come" aria-hidden="true"><span class="octicon octicon-link"></span></a>More to Come</h3>

<p>Lightstack is a brand new project and will change over time to become more powerful and useful. Run the example project(s) under the example folder to try out a simple example.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/mckay20/lightstack">Lightstack</a> is maintained by <a href="https://github.com/mckay20">mckay20</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
